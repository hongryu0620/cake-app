<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë“œë˜ê·¸ì•¤ë“œë¡­ ì¼€ì´í¬ ê¾¸ë¯¸ê¸° (ìµœì¢…)</title>
    <style>
        /*
        --------------------
        1. CSS ìŠ¤íƒ€ì¼ (ê²¹ì¹˜ê¸° ë° ì‚¬ì´ì¦ˆ í†µì¼ ë°˜ì˜)
        --------------------
        */
        body {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            font-family: sans-serif;
        }

        #app-container {
            display: flex;
            width: 900px;
            margin-top: 50px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
        }

        /* ğŸ‚ ì¼€ì´í¬ (ë“œë¡­ ì˜ì—­) ìŠ¤íƒ€ì¼ */
        #drop-area {
            flex-basis: 70%;
            position: relative;
            background-color: #ffe0b2;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 30px;
            min-height: 600px;
        }

        /* **í•µì‹¬ 1: ì¼€ì´í¬ ì´ë¯¸ì§€ í¬ê¸° ê¸°ì¤€** */
        #person-image {
            width: 90%; 
            max-width: 450px; 
            height: auto;
            position: relative; /* ìƒëŒ€ ìœ„ì¹˜ ì„¤ì • (ê²¹ì³ì§€ëŠ” ìš”ì†Œì˜ ê¸°ì¤€) */
            z-index: 1;
        }

        /* ğŸ¦ ì˜· (ë“œë˜ê·¸ ê°€ëŠ¥í•œ ì•„ì´í…œ) ìŠ¤íƒ€ì¼ */
        #clothes-tray {
            flex-basis: 30%;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f8f8f8;
            border-left: 2px solid #eee;
        }

        .tray-title {
            color: #333;
            margin-bottom: 20px;
        }

        /* **í•µì‹¬ 2: íŠ¸ë ˆì´ì˜ ì˜· ì´ë¯¸ì§€ í¬ê¸°ë¥¼ ì‘ê²Œ ìœ ì§€ (ì„ íƒìš©)** */
        .draggable-item {
            width: 120px; /* ì„ íƒí•˜ê¸° ì¢‹ê²Œ ì‘ê²Œ ìœ ì§€ */
            height: 120px;
            object-fit: contain;
            cursor: grab;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 5px;
            background-color: white;
            margin: 15px 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* **í•µì‹¬ 3: ë“œë¡­ëœ ì˜· ìŠ¤íƒ€ì¼ - ì¼€ì´í¬ì™€ ë™ì¼í•˜ê²Œ ì„¤ì •** */
        .dropped-item {
            position: absolute;
            /* ì¼€ì´í¬ ì´ë¯¸ì§€ì™€ ë™ì¼í•˜ê²Œ ê²¹ì³ì§€ë„ë¡ ì„¤ì • */
            width: 90%;
            max-width: 450px; 
            height: auto;
            top: 50%; /* ë“œë¡­ ì˜ì—­ ì¤‘ì•™ì— ìœ„ì¹˜ */
            left: 50%;
            transform: translate(-50%, -50%); /* ì •í™•í•œ ì¤‘ì•™ ì •ë ¬ */

            z-index: 10; 
            cursor: pointer;
            box-shadow: none; /* ê²¹ì¹  ë•Œ ê·¸ë¦¼ì ì œê±° */
            /* ë°°ê²½ íˆ¬ëª… ìœ ì§€ë¥¼ ìœ„í•´ object-fit: contain ì œê±° */
        }
        
        .dragging {
            opacity: 0.4;
            border: 2px dashed #333;
        }
    </style>
</head>
<body ondrop="bodyDrop(event)" ondragover="allowDrop(event)">
    
<div id="app-container">
    <div id="drop-area" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="person-image" src="CAKE.PNG" alt="ì¼€ì´í¬ ì´ë¯¸ì§€">
    </div>

    <div id="clothes-tray">
        <h3 class="tray-title">âœ¨ ë°ì½”ë ˆì´ì…˜ ì„ íƒ âœ¨</h3>
        <img id="cream1" src="CREAM1.PNG" class="draggable-item" draggable="true" ondragstart="drag(event)">
        <img id="cream2" src="CREAM2.PNG" class="draggable-item" draggable="true" ondragstart="drag(event)">
        <img id="cream3" src="CREAM3.PNG" class="draggable-item" draggable="true" ondragstart="drag(event)">
    </div>
</div>

<script>
    /*
    --------------------
    2. JavaScript ê¸°ëŠ¥ (ê²¹ì¹˜ë„ë¡ ìˆ˜ì •)
    --------------------
    */
    let draggedElement = null;
    let placedItems = {}; // í˜„ì¬ ì¼€ì´í¬ ìœ„ì— ì˜¬ë¼ì™€ ìˆëŠ” í¬ë¦¼ì„ ì¶”ì  (ID: Element)

    function drag(event) {
        event.dataTransfer.setData("text/plain", event.target.id);
        draggedElement = event.target;
        
        // íŠ¸ë ˆì´ì— ìˆëŠ” ì›ë³¸ ì•„ì´í…œë§Œ ì ì‹œ ìˆ¨ê¹€
        if (event.target.parentElement.id === 'clothes-tray') {
            event.target.classList.add('dragging'); 
        }
    }

    function allowDrop(event) {
        event.preventDefault();
    }

    // 3. ì¼€ì´í¬ (drop-area)ì— ë“œë¡­ì´ ì¼ì–´ë‚¬ì„ ë•Œ í˜¸ì¶œ
    function drop(event) {
        event.preventDefault();

        const data = event.dataTransfer.getData("text/plain");
        const originalElement = document.getElementById(data);
        const dropArea = document.getElementById('drop-area');

        // A. íŠ¸ë ˆì´ì—ì„œ ì¼€ì´í¬ë¡œ ë“œë¡­ (ìƒˆë¡œìš´ ì˜· ì¶”ê°€)
        if (originalElement.parentElement.id === 'clothes-tray') {
            const creamId = originalElement.id;

            // **í•µì‹¬ 4: ê¸°ì¡´ì— í•´ë‹¹ ì¢…ë¥˜ì˜ ì˜·ì´ ìˆìœ¼ë©´ ë¨¼ì € ì œê±°**
            // (í•˜ë‚˜ì˜ ì¼€ì´í¬ ìœ„ì— ë™ì¼í•œ ì¢…ë¥˜ì˜ í¬ë¦¼ì´ ì—¬ëŸ¬ ê°œ ê²¹ì¹˜ëŠ” ê²ƒì„ ë°©ì§€)
            if (placedItems[creamId]) {
                placedItems[creamId].remove();
            }

            const newElement = originalElement.cloneNode(true);
            newElement.id = 'placed-' + creamId; // ê³ ìœ  ID ë¶€ì—¬
            
            // í´ë˜ìŠ¤ ë° ì†ì„± ì„¤ì •
            newElement.classList.remove('draggable-item', 'dragging');
            newElement.classList.add('dropped-item');
            newElement.setAttribute('ondragstart', 'drag(event)'); // ë‹¤ì‹œ ë“œë˜ê·¸í•  ìˆ˜ ìˆë„ë¡

            // **ê²¹ì¹˜ê¸° êµ¬í˜„: ìœ„ì¹˜ë¥¼ ì¤‘ì•™ìœ¼ë¡œ ì„¤ì •**
            // CSSì—ì„œ ì´ë¯¸ top: 50%, left: 50%, transform: translate(-50%, -50%)ë¡œ ì„¤ì •í–ˆìœ¼ë¯€ë¡œ
            // JSì—ì„œ ë³„ë„ì˜ ì¢Œí‘œ ê³„ì‚° í•„ìš” ì—†ì´ ê·¸ëƒ¥ ì¶”ê°€ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.
            
            dropArea.appendChild(newElement);
            placedItems[creamId] = newElement; // ë§µì— ì¶”ê°€

            // ì›ë³¸ ë³µêµ¬
            originalElement.classList.remove('dragging');

        } 
        // B. ì¼€ì´í¬ ìœ„ì—ì„œ ë“œë¡­ (ê²¹ì¹˜ê¸° ëª¨ë“œì—ì„œëŠ” ìœ„ì¹˜ ì´ë™ ê¸°ëŠ¥ ì œê±°)
        // ê²¹ì¹˜ê¸° ëª¨ë“œì—ì„œëŠ” ë“œë¡­ëœ ì•„ì´í…œì„ ë‹¤ì‹œ ë“œë¡­í•´ë„ ìœ„ì¹˜ê°€ ì¤‘ì•™ìœ¼ë¡œ ê³ ì •ë©ë‹ˆë‹¤.
        else if (originalElement.parentElement.id === 'drop-area') {
            // ìœ„ì¹˜ê°€ ê³ ì •ë˜ë¯€ë¡œ, ë“œë¡­ ì´ë²¤íŠ¸ë¥¼ ë¬´ì‹œí•˜ê±°ë‚˜ Z-indexë§Œ ì¡°ì • ê°€ëŠ¥
            originalElement.style.zIndex = 100; // ê°€ì¥ ìœ„ë¡œ ì˜¬ë¦¬ê¸°
        }

        draggedElement = null;
    }
    
    // 4. Body (ì „ì²´ í™”ë©´)ì— ë“œë¡­ì´ ì¼ì–´ë‚¬ì„ ë•Œ í˜¸ì¶œ (ì˜· ë²—ê¸°ê¸°/ì œê±°)
    function bodyDrop(event) {
        event.preventDefault();
        
        const data = event.dataTransfer.getData("text/plain");
        const elementToDrop = document.getElementById(data);

        // ë“œë¡­ëœ ìš”ì†Œê°€ 'dropped-item'ì¸ ê²½ìš° (ì¼€ì´í¬ ìœ„ì— ìˆë˜ ì˜·)
        if (elementToDrop && elementToDrop.classList.contains('dropped-item')) {
            
            // 1. DOMì—ì„œ í•´ë‹¹ ìš”ì†Œ (ì¼€ì´í¬ ìœ„ì˜ ì˜·) ì œê±°
            elementToDrop.remove();
            
            // 2. ì¶”ì  ë§µì—ì„œ ì œê±°
            const originalCreamId = elementToDrop.id.replace('placed-', '');
            delete placedItems[originalCreamId];
            
            console.log(elementToDrop.id + " ì œê±°ë¨ (ì˜· ë²—ê¸°ê¸°/ì›ìœ„ì¹˜ ë³µêµ¬).");

        } else if (elementToDrop && elementToDrop.parentElement.id === 'clothes-tray') {
            // íŠ¸ë ˆì´ì—ì„œ ëŒì–´ì˜¨ ì˜·ì„ ì¼€ì´í¬ê°€ ì•„ë‹Œ ê³³ì— ë†“ì•˜ì„ ë•Œ ì›ë³¸ ë³µêµ¬
            elementToDrop.classList.remove('dragging');
        }
        
        draggedElement = null;
    }
</script>

</body>
</html>